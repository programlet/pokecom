10 ' POCKET CHAT ver.2 ----------------
20 '
30 CLEAR :DIM L$(19),U$(9),N$(7):L$(0)="--< POCKET CHAT ver.2 >--",U$(0)="ROOT"
40 A$="## &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&"
50 LOCATE 0,3:PRINT USING "[Ò¯¾-¼Þ][ Õ-»Þ ][ »Ý¶  ][ À²¼Â ]&&&&&&&&";U$(U):P=0
60 FOR I=0TO 2:LOCATE 0,I:PRINT USING A$;I+P;L$(I+P):NEXT
70 K=0:WHILE K=0:K=ASC INKEY$ :WEND
80 ON K-240GOTO 100,150,170,200
90 P=P+(K=4AND P>0)-(K=5AND P<17):IF K=76GOTO 230ELSE 60
100 GOSUB 310:LOCATE 3,3:PRINT U$(U);":";:M$="":INPUT M$:IF M$=""GOTO 50
110 L=LEN M$,K=0,R=36-LEN U$(U)
120 WHILE L>0:IF K LET N$(K)=LEFT$ ("        ",LEN U$(U)+1)ELSE N$(K)=U$(U)+":"
130 N$(K)=N$(K)+MID$ (M$,K*R+1,R),L=L-R,K=K+1:WEND :IF F$ FOR I=0TO K-1:PRINT #1,N$(I):NEXT
140 FOR I=0TO 19-K:L$(19-I)=L$(19-I-K):NEXT :FOR I=0TO K-1:L$(I)=N$(I):NEXT
150 U=-(U+1)*(U<N):IF N>0AND U=0LET U=1
160 GOTO 50
170 GOSUB 310:LOCATE 3,3:PRINT "NAME(LENGTH<9):";:M$="":INPUT M$:IF M$=""GOTO 50
180 N=N+1,U$(N)=LEFT$ (M$,8):GOSUB 290:L$(0)="<INFO:"+U$(N)+" »Ý¶Þ »Ý¶ »ÚÏ¼À>":IF F$ PRINT #1,L$(0)
190 U=U+1:GOTO 50
200 IF U<1GOTO 220ELSE GOSUB 290:L$(0)="<INFO:"+U$(U)+" »Ý¶Þ À²¼Â »ÚÏ¼À>":IF F$ PRINT #1,L$(0)
210 FOR I=U TO 8:U$(I)=U$(I+1):NEXT :N=N-1,U=U-1:GOTO 150
220 IF F$ GOTO 280ELSE END
230 IF F$ GOTO 280
240 GOSUB 310:LOCATE 3,3:F$="":INPUT "LOGFILE:";F$:IF F$=""GOTO 50
250 ON ERROR GOTO 270:OPEN F$ FOR OUTPUT AS #1:ON ERROR GOTO 0
260 GOSUB 290:L$(0)="<LOGOUT "+F$+" OPEN>":PRINT #1,L$(0):GOTO 50
270 GOSUB 310:LOCATE 3,3:PAUSE "BAD FILE NAME":F$="":GOTO 50
280 L$="<LOGFILE "+F$+" CLOSE>":PRINT #1,L$:CLOSE :F$="":GOSUB 290:L$(0)=L$:GOTO 50
290 FOR I=0TO 18:L$(19-I)=L$(18-I):NEXT :RETURN
310 LOCATE 0,3:PRINT "                                        ":RETURN
320 OPEN "E:LOG.LOG"FOR INPUT AS #1:WHILE EOF 1=0:INPUT #1,A$:PAUSE A$:WEND :CLOSE
